import{m as g}from"./marked.esm.e7769a72.js";import{_,o as d,c as u,d as n,t as c,w as T,v as b,n as L,h as D,j as f,k as C,u as m,r as x,F as w,l as y,q as H,g as N,s as v,x as S,a as B,f as p,y as I,z as k}from"./index.3d7503fa.js";const q={props:["parentdata","content"],data(){return{cellNum:this.parentdata,id:this.parentdata,fontSize:"18px",txt:"",bq:"",markTxt:"",markClass:"markText"}},watch:{content(e,t){this.markTxt=e.content,this.txt=g(e.content),this.changeTextareaHeight()}},methods:{markedParse(e){return g(e)},markToHtml(e){let t=e.target||this.$refs.textareaRef,s=t.nextSibling,l=t;for(;!l.classList.contains("content");)l=l.parentNode;console.log(t.value),this.txt=g(t.value),s.style.display="block",setTimeout(()=>{t.style.height=s.offsetHeight+"px",l.style.height=s.offsetHeight+"px"},10)},htmlToMark(e){let t=e.target;for(;!t.classList.contains("htmlText");)t=t.parentNode;this.txt="",t.style.display="none",this.changeTextareaHeight()},changeTextareaHeight(){let e=this.$refs.textareaRef,t=e;for(;!t.classList.contains("content");)t=t.parentNode;var s=e.scrollHeight,l=e.offsetHeight;l<=s&&(e.style.height="auto",e.style.height=e.scrollHeight+"px",t.style.height=e.scrollHeight+"px")},addUp(e){let t=e.target;for(;!t.classList.contains("note");)t=t.parentNode;let s=[t,this.content];this.markTxt="",this.$emit("addUp",s)},addDown(e){let t=e.target;for(;!t.classList.contains("note");)t=t.parentNode;this.$emit("addDown",t)},moveUp(e){let t=e.target;for(;!t.classList.contains("note");)t=t.parentNode;this.$emit("moveUp",t)},moveDown(e){let t=e.target;for(;!t.classList.contains("note");)t=t.parentNode;this.$emit("moveDown",t)},deleteNote(e){let t=e.target;for(;!t.classList.contains("note");)t=t.parentNode;this.$emit("deleteNote",t)},changeBiaoqian(e){let t=e.target;this.bq=t.innerHTML,this.content.title=this.bq}},mounted:function(){this.markTxt=this.content.content,this.txt=g(this.content.content);let e=this.$refs.textareaRef,t=e.nextSibling,s=e;for(;!s.classList.contains("content");)s=s.parentNode;this.txt=g(e.value),t.style.display="block",setTimeout(()=>{e.style.height=t.offsetHeight+"px",s.style.height=t.offsetHeight+"px"},10),this.changeTextareaHeight()}},A={class:"note"},U={class:"head"},M={class:"head_left"},O=n("div",{class:"round",style:{"background-color":"#FC625D"}},null,-1),j=n("div",{class:"round",style:{"background-color":"#FDBC40"}},null,-1),V=n("div",{class:"round",style:{"background-color":"#35CD4B"}},null,-1),F={class:"titleNum"},R=n("div",{class:"head_right"},null,-1),z={class:"function"},P=n("i",{class:"fa fa-plus-square-o"},null,-1),E=[P],W=n("i",{class:"fa fa-plus-square"},null,-1),G=[W],J=n("i",{class:"fa fa-arrow-up"},null,-1),K=[J],Q=n("i",{class:"fa fa-arrow-down"},null,-1),X=[Q],Y=n("i",{class:"fa fa-trash-o"},null,-1),Z=[Y],$={class:"content",ref:"contentWrapper"},tt=["onblur"],et=["innerHTML"],nt={class:"rightAttribute"},st=n("span",null,"cell\u7F16\u53F7\uFF1A",-1),ot=n("span",null,"Id\uFF1A",-1),lt=n("span",null,"\u6807\u7B7E\u540D\uFF1A",-1),it=n("span",null,"createTime:",-1),at=n("span",null,"updateTime:",-1),ct=n("span",null,"\u4F5C\u8005\uFF1A",-1),rt=n("span",null,"fontSize\uFF1A",-1);function dt(e,t,s,l,a,o){return d(),u("div",A,[n("div",U,[n("div",M,[O,j,V,n("div",F,c(s.parentdata),1),n("div",{class:"titleName",contenteditable:"true",onInput:t[0]||(t[0]=(...i)=>o.changeBiaoqian&&o.changeBiaoqian(...i))},c(s.content.title),33)]),R,n("div",z,[n("div",{class:"func file-up",onClick:t[1]||(t[1]=(...i)=>o.addUp&&o.addUp(...i))},E),n("div",{class:"func file-down",onClick:t[2]||(t[2]=(...i)=>o.addDown&&o.addDown(...i))},G),n("div",{class:"func move-up",onClick:t[3]||(t[3]=(...i)=>o.moveUp&&o.moveUp(...i))},K),n("div",{class:"func move-down",onClick:t[4]||(t[4]=(...i)=>o.moveDown&&o.moveDown(...i))},X),n("div",{class:"func delete",onClick:t[5]||(t[5]=(...i)=>o.deleteNote&&o.deleteNote(...i))},Z)])]),n("div",$,[T(n("textarea",{class:L(a.markClass),ref:"textareaRef","onUpdate:modelValue":t[6]||(t[6]=i=>a.markTxt=i),onClick:t[7]||(t[7]=D((...i)=>o.markToHtml&&o.markToHtml(...i),["ctrl"])),onblur:o.markToHtml},null,10,tt),[[b,a.markTxt]]),n("div",{class:"htmlText markdown-body",ref:"htmlTxt",innerHTML:o.markedParse(a.markTxt),onDblclick:t[8]||(t[8]=(...i)=>o.htmlToMark&&o.htmlToMark(...i))},null,40,et)],512),n("div",nt,[n("div",null,[st,n("span",null,c(a.cellNum),1)]),n("div",null,[ot,n("span",null,c(a.id),1)]),n("div",null,[lt,n("span",{contenteditable:"true",onInput:t[9]||(t[9]=(...i)=>o.changeBiaoqian&&o.changeBiaoqian(...i))},c(s.content.title),33)]),n("div",null,[it,n("span",null,c(s.content.createTime),1)]),n("div",null,[at,n("span",null,c(s.content.updateTime),1)]),n("div",null,[ct,n("span",null,c(s.content.author),1)]),n("div",null,[rt,n("span",null,c(a.fontSize),1)])])])}const ut=_(q,[["render",dt]]),ht={props:["texts","noteId","user"],watch:{async noteId(e,t){this.textcontent=await f(e),setTimeout(()=>{this.changeHeight()},100)},textcontent(e,t){this.textcontent=C(e),setTimeout(()=>{this.changeHeight()},100)}},data(){return{parentdata:"",comName:[{name:"Block"},{name:"Block"}],textcontent:[]}},components:{Block:ut},methods:{changeHeight(){let e=document.querySelectorAll(".content"),t=document.querySelectorAll(".markText"),s=document.querySelectorAll(".htmlText");for(let l=0;l<e.length;l++)e[l].style.height=Math.max(s[l].offsetHeight,t[l].offsetHeight)+"px"},shang(e){let t=document.querySelectorAll(".note"),s=[].indexOf.call(t,e[0]),l={title:"\u65B0\u5EFA\u7B14\u8BB0",author:this.user.id,content:"",createTime:new Date().toLocaleDateString(),updateTime:new Date().toLocaleDateString()};this.textcontent.splice(s,0,l),this.textcontent.splice(s+1,1,e[1]),setTimeout(()=>{this.changeHeight()},100),m(this.noteId,this.textcontent)},xia(e){let t=document.querySelectorAll(".note"),s=[].indexOf.call(t,e),l={title:"\u65B0\u5EFA\u7B14\u8BB0",author:this.user.id,content:"",createTime:new Date().toLocaleDateString(),updateTime:new Date().toLocaleDateString()};this.textcontent.splice(s+1,0,l),setTimeout(()=>{this.changeHeight()},100),m(this.noteId,this.textcontent)},moveUp(e){let t=document.querySelectorAll(".note"),s=[].indexOf.call(t,e);if(s>0){let l=this.textcontent[s-1],a=this.textcontent[s];this.textcontent.splice(s-1,1,a),this.textcontent.splice(s,1,l),setTimeout(()=>{this.changeHeight()},100)}else return},moveDown(e){let t=document.querySelectorAll(".note"),s=[].indexOf.call(t,e);if(s<t.length-1){let l=this.textcontent[s+1],a=this.textcontent[s];this.textcontent.splice(s+1,1,a),this.textcontent.splice(s,1,l),setTimeout(()=>{this.changeHeight()},100)}else return},deleteNote(e){let t=document.querySelectorAll(".note"),s=[].indexOf.call(t,e);console.log(s),this.textcontent.splice(s,1),setTimeout(()=>{this.changeHeight()},100),m(this.noteId,this.textcontent)}},mounted:async function(){this.textcontent=await f(this.noteId)}};function gt(e,t,s,l,a,o){const i=x("Block");return d(),u("div",null,[(d(!0),u(w,null,y(a.textcontent,(h,r)=>(d(),H(i,{key:r,content:h,parentdata:r+1,onAddUp:o.shang,onAddDown:o.xia,onMoveUp:o.moveUp,onMoveDown:o.moveDown,onDeleteNote:o.deleteNote,data:r},null,8,["content","parentdata","onAddUp","onAddDown","onMoveUp","onMoveDown","onDeleteNote","data"]))),128))])}const mt=_(ht,[["render",gt]]);const _t={props:["user"],data(){return{cnt:"0",noteList:["intro"],current_user:{}}},watch:{async user(e,t){let s=await N(this.user.id);this.current_user=s,console.log(this.current_user.noteList);let l=this.current_user.noteList,a=[];if(l!="undefined")for(let o=0;o<l.length;o++)a.push(l[o]);a[0]!="intro"&&a.unshift("intro"),this.noteList=a}},methods:{incent(e){let t=e.target;t.style.display="none";let s=t.nextSibling;for(s.style.display="block";!t.classList.contains("viewLeftBar");)t=t.parentNode;t.style.transform="translate(-300px,0)"},extend(e){let t=e.target;t.style.display="none";let s=t.previousSibling;for(s.style.display="block";!t.classList.contains("viewLeftBar");)t=t.parentNode;t.style.transform="translate(0,0)"},exit(){this.$router.push("/")},addNoteList(){this.cnt=this.current_user.noteList.length+1;let e=this.current_user.id+"\u65B0\u5EFA\u7B14\u8BB0"+this.cnt;this.current_user.noteList.push(e),console.log(this.current_user),v(this.current_user);let t={title:"\u65B0\u5EFA\u7B14\u8BB0",author:this.user.id,content:"",createTime:new Date().toLocaleDateString(),updateTime:new Date().toLocaleDateString()};S(e,[t]),alert("\u6DFB\u52A0\u6210\u529F"),setTimeout(()=>{window.location.reload()},1e3)},changeNote(e){console.log(e.target.getAttribute("content")),this.$emit("changeNote",e.target.getAttribute("content"))},getCookieObject(){let e=document.cookie;e=e.substring(0,e.length);let t=e.split("; "),s={};return t.forEach(l=>{let a=l.substring(0,l.indexOf("=")),o=l.substring(l.indexOf("=")+1);o=decodeURIComponent(o),s[a]=o}),s},async deleteNote(e){e.stopPropagation();let t=e.target.getAttribute("index");this.noteList.splice(t,1);let s=this.getCookieObject();s.noteList=this.noteList,console.log(s.id),v(s);let l=e.target.getAttribute("noteId");B({url:`http://123.60.44.50:3000/notes/${l}`,method:"delete"}).then(a=>{console.log("\u5220\u9664\u6210\u529F")})}},mounted:function(){}},ft={class:"viewLeftBar"},xt={class:"extendAndIncent"},pt={class:"title"},vt={class:"title_left"},kt=n("img",{src:p,alt:""},null,-1),wt={class:"title_right"},yt=n("div",{class:"headPhoto"},[n("img",{src:p,alt:""}),n("i",{class:"fa fa-angle-down"})],-1),Nt={class:"updateInfoBlock"},Tt={class:"selfInfo"},bt=n("img",{src:p,alt:""},null,-1),Lt=n("div",null,[n("i",{class:"fa fa-gear"}),n("span",null,"\u8D26\u6237\u8BBE\u7F6E")],-1),Dt=n("i",{class:"fa fa-sign-out"},null,-1),Ct=n("span",null,"\u9000\u51FA\u767B\u5F55",-1),Ht=[Dt,Ct],St={class:"catalog"},Bt=n("span",null,"\u76EE\u5F55",-1),It=["content"],qt=["index","noteId"];function At(e,t,s,l,a,o){return d(),u("div",ft,[n("div",xt,[n("i",{class:"fa fa-hand-o-left",onClick:t[0]||(t[0]=(...i)=>o.incent&&o.incent(...i))}),n("i",{class:"fa fa-hand-o-right",onClick:t[1]||(t[1]=(...i)=>o.extend&&o.extend(...i))})]),n("div",pt,[n("div",vt,[kt,n("span",null,c(this.user.id),1)]),n("div",wt,[yt,n("div",Nt,[n("div",Tt,[bt,n("span",null,c(this.user.name),1)]),Lt,n("div",{onClick:t[2]||(t[2]=(...i)=>o.exit&&o.exit(...i))},Ht)])])]),n("div",St,[Bt,n("i",{class:"fa fa-plus-square-o",onClick:t[3]||(t[3]=(...i)=>o.addNoteList&&o.addNoteList(...i))},"\u6DFB\u52A0")]),(d(!0),u(w,null,y(a.noteList,(i,h)=>(d(),u("div",{class:"noteId",key:h,content:i,onClick:t[5]||(t[5]=(...r)=>o.changeNote&&o.changeNote(...r))},[I(c(i)+" ",1),n("span",{class:"deleteNote",onClick:t[4]||(t[4]=(...r)=>o.deleteNote&&o.deleteNote(...r)),index:h,noteId:i},"\xD7",8,qt)],8,It))),128))])}const Ut=_(_t,[["render",At]]);const Mt={components:{NoteFunc:mt,LeftBar:Ut},data(){return{noteId:"intro",texts:[],user:{},cur_user:{}}},methods:{getCookieObject(){let e=document.cookie;e=e.substring(0,e.length);let t=e.split("; "),s={};return t.forEach(l=>{let a=l.substring(0,l.indexOf("=")),o=l.substring(l.indexOf("=")+1);o=decodeURIComponent(o),s[a]=o}),s},async saveNote(){let e=document.querySelectorAll(".markText"),t=document.querySelectorAll(".titleName"),s=[];for(let l=0;l<e.length;l++){let a={title:t[l].innerHTML,author:this.user.id,content:e[l].value,createTime:new Date().toLocaleDateString(),updateTime:new Date().toLocaleDateString()};s.push(a)}m(this.noteId,s),alert("\u4FDD\u5B58\u6210\u529F")},back(){this.$router.push("/home")},changeNote(e){this.noteId=e}},mounted:async function(){this.user=await this.getCookieObject(),console.log(this.user),this.texts=await f(this.noteId),this.cur_user=await N(this.user.id)}},Ot={class:"notePage"},jt={class:"centetNote"};function Vt(e,t,s,l,a,o){const i=x("LeftBar"),h=x("NoteFunc");return d(),u("div",Ot,[k(i,{user:a.user,onChangeNote:o.changeNote},null,8,["user","onChangeNote"]),n("div",jt,[k(h,{noteId:a.noteId,user:a.user},null,8,["noteId","user"])]),n("button",{class:"button",onClick:t[0]||(t[0]=(...r)=>o.saveNote&&o.saveNote(...r))},"\u4FDD\u5B58"),n("button",{class:"button",onClick:t[1]||(t[1]=(...r)=>o.back&&o.back(...r))},"\u8FD4\u56DE")])}const zt=_(Mt,[["render",Vt]]);export{zt as default};
